library(tidyverse)
library(readxl)
library(here)
install.packages('here')
library(here)
readxl("BC_injuries_2007_08_2008_09.xlsx")
library(readxl)
read_excel("BC_injuries_2007_08_2008_09.xlsx")
view(read_excel("BC_injuries_2007_08_2008_09.xlsx"))
view(read_excel("BC_injuries_2007_08_2008_09.xlsx", skip = 19))
view(read_excel("BC_injuries_2007_08_2008_09.xlsx", skip = 20))
injuries_2007 <- view(read_excel("BC_injuries_2007_08_2008_09.xlsx", skip = 20))
injuries_2007 <- injuries_2007 %>% fill(Region)
injuries_2007 <- injuries_2007 %>% fill(Region)
source('~/Personal R Projects/bc_injury_data/bc_injury_data.R', echo=TRUE)
fill(Region) %>%
subset(1:100)
injuries_2007 <- injuries_2007 %>%
fill(Region) #%>%
#subset(1:100)
view(injuries_2007)
injuries_2007 <- injuries_2007 %>%
fill(Region) %>%
filter(Region %in% 'Interior')
view(injuries_2007)
injuries_2007 <- view(read_excel("BC_injuries_2007_08_2008_09.xlsx", skip = 20))
injuries_2007 <- injuries_2007 %>%
fill(Region) %>%
filter(Region %in% 'Interior', 'Fraser', 'Vancouver Coastal',
'Island', 'Northern')
view(injuries_2007)
injuries_2007 <- injuries_2007 %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser', 'Vancouver Coastal',
'Island', 'Northern'))
view(injuries_2007)
injuries_2007_raw <- view(read_excel("BC_injuries_2007_08_2008_09.xlsx", skip = 20))
injuries_2007 <- injuries_2007_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
# Region in raw data is recorded only when it changes.
# Removes NAs from Region by filling in values.
# Removes non-data rows from raw data
view(injuries_2007)
injuries_2007_raw <- read_excel(here("BC_injuries_2007_08_2008_09.xlsx"), skip = 20)
injuries_2007 <- injuries_2007_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
# Region in raw data is recorded only when it changes.
# Removes NAs from Region by filling in values.
# Removes non-data rows from raw data
view(injuries_2007)
injuries_2007_raw <- read_excel(here("BC_injuries_2007_08_2008_09.xlsx"))
injuries_2007 <- injuries_2007_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
# Region in raw data is recorded only when it changes.
# Removes NAs from Region by filling in values.
# Removes non-data rows from raw data
view(injuries_2007)
injuries_2007_raw <- read_excel(here("BC_injuries_2007_08_2008_09.xlsx", skip = 20))
injuries_2007_raw <- read_excel(here("BC_injuries_2007_08_2008_09.xlsx", skip = 20))
injuries_2007_raw <- read_excel(here("BC_injuries_2007_08_2008_09.xlsx"), skip = 20)
injuries_2007 <- injuries_2007_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
# Region in raw data is recorded only when it changes.
# Removes NAs from Region by filling in values.
# Removes non-data rows from raw data
view(injuries_2007)
injuries_2007_raw <- read_excel(here("BC_injuries_2007_08_2008_09.xlsx"), skip = 20)
injuries_2007_raw <- read_excel(here("BC_injuries_2007_08_2008_09.xlsx"), skip = 20)
injuries_2009_raw <- read_excel(here("BC_injuries_2009_10_2010_11.xlsx"), skip = 20)
injuries_2011_raw <- read_excel(here("BC_injuries_2011_12_2012_13.xlsx"), skip = 20)
injuries_2013_raw <- read_excel(here("BC_injuries_2013_14_2014_15.xlsx"), skip = 20)
injuries_2015_raw <- read_excel(here("BC_injuries_2015_16_2016_17.xlsx"), skip = 20)
# Region in raw data is recorded only when it changes.
# Removes NAs from Region by filling in values.
# Removes non-data rows from raw data
injuries_2007 <- injuries_2007_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
injuries_2009 <- injuries_2009_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
injuries_2011 <- injuries_2011_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
injuries_2013 <- injuries_2013_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
injuries_2015 <- injuries_2015_raw %>%
fill(Region) %>%
filter(Region %in% c('Interior', 'Fraser',
'Vancouver Coastal', 'Island', 'Northern'))
view(injuries_2009)
view(injuries_2009)
view(injuries_2009)
view(injuries_2011)
view(injuries_2013)
view(injuries_2015)
injuries_2012_raw <- read_excel(here("BC_injuries_2012"), skip = 20)
injuries_2013_raw <- read_excel(here("BC_injuries_2013"), skip = 20)
injuries_2014_raw <- read_excel(here("BC_injuries_2014"), skip = 20)
injuries_2015_raw <- read_excel(here("BC_injuries_2015"), skip = 20)
injuries_2016_raw <- read_excel(here("BC_injuries_2016"), skip = 20)
injuries_2012_raw <- read_excel(here("BC_injuries_2012"), skip = 20)
injuries_2013_raw <- read_excel(here("BC_injuries_2013"), skip = 20)
injuries_2014_raw <- read_excel(here("BC_injuries_2014"), skip = 20)
injuries_2015_raw <- read_excel(here("BC_injuries_2015"), skip = 20)
injuries_2016_raw <- read_excel(here("BC_injuries_2016"), skip = 20)
injuries_2012_raw <- read_excel(here("BC_injuries_2012"), skip = 20)
injuries_2012_raw <- read_excel(here("BC_injuries_2012"), skip = 20)
